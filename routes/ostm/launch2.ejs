<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <meta name="description" content="UOW Online STM">
  <meta name="author" content="www.jeffreybarron.com">

  <!--Express wasnt rendering on the browsers -->
  <meta http-equiv="cache-control" content="max-age=0" />
  <meta http-equiv="cache-control" content="no-cache" />
  <meta http-equiv="expires" content="0" />
  <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
  <meta http-equiv="pragma" content="no-cache" />

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

  <!-- Custom styles for this template -->
  <link rel="stylesheet" href="/<%= rPath %>/static/launch.css">
  <title>UOW CogLab</title>

</head>

<body>
  <noscript>
    <h1>JavaScript Required</h1>
    <p class="lead">This Website requires Javascript, i.e. it will not work without it.</p>
    <p class="lead">If you wish to use this site you will need to enable Javasript,
      however by enabling JavaScript, you are do so at your own risk.</p>
    <p class="lead">If you're cool with that, Here are the <a href="https://www.enable-javascript.com/">instructions to
        enable JavaScript</a> in your web browser.</p>
  </noscript>
  <div class="container">
    <div id="headerContainer" class="row">
      <h2>University of Wollongong</h3>
        <h1>School of Psychology - CogLab</h1>
        <h3 id="pageTitle">Short Term Memory (STM) Study
      </h2>
      <hr>
    </div>
    <div id="centerRow" class="row">
      <div id="pageLeft" class="col-sm">
        <!-- Left Gutter -->
      </div>
      <div id="contentContainer" class="col-sm">
        <!-- Page Content -->
        <h4>Enter a valid Study Name</h3>
          <div class="starter-template">
            <div class="form-group row">
              <label for="studyName" class="col-sm-3 col-form-label">Study Name</label>
              <div class="col-sm-9">
                <input class="form-control" type="text" id="studyName" name="studyName"
                  placeholder="(Required: Enter the Study Name exactly as provided)"></input>
                <small class="form-text">Required: Enter the Study Name exactly as provided</small>
              </div>

            </div>
            <div class="form-group row">
              <label for="STUDY_ID" class="col-sm-3 col-form-label">STUDY_ID</label>
              <div class="col-sm-9">
                <input class="form-control" type="text" id="STUDY_ID" name="STUDY_ID"
                  placeholder="(Optional: Enter Subject Code e.g. PSYC327)"></input>
                <small class="form-text">Optional: Enter Subject Code e.g. PSYC327</small>
              </div>
            </div>
            <div class="form-group row">
              <label for="SESSION_ID" class="col-sm-3 col-form-label">SESSION_ID</label>
              <div class="col-sm-9">
                <input class="form-control" type="text" id="SESSION_ID" name="SESSION_ID"
                  placeholder="(Optional: Enter Tutorial Day-Time e.g. MON-11:00am)"></input>
                <small class="form-text">Optional: Enter Tutorial Day-Time e.g. MON-11:00am</small>
              </div>
            </div>
            <button id="" type="submit" class="btn btn-primary" onclick="executePreFlight()">Execute Test</button>
          </div>
      </div>
      <div id="pageRight" class="col-sm">
        <!-- Right Gutter -->
      </div>

    </div>
    <div id="footerContainer" class="row">
      <footer class="footer">
        <p class="text-muted">Solution by <a href="http://www.jeffreybarron.com">jeffreybarron.com</a> for
          <br />University of Wollongong. CRICOS Provider No: 00102E</p>
      </footer>
    </div>

    <img class="logo" src="/static/uow.png" alt="University of Wollongong Australia">

    <!-- End of Main Body -->
    <script>
      let params = new URLSearchParams(document.location.search.substring(1));
      if (params.get("studyName") !== 'undefined') {
        document.getElementById("studyName").value = params.get("studyName");
      };
    </script>
    <script type="text/javascript">
      function create_UUID() {
        var dt = new Date().getTime();
        var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
          var r = (dt + Math.random() * 16) % 16 | 0;
          dt = Math.floor(dt / 16);
          return (c == 'x' ? r : (r & 0x3 | 0x8)).toString(16);
        });
        return uuid;
      };
    </script>
    <script type="text/javascript">
      function executePreFlight() {
        var studyName = document.getElementById("studyName").value;
        var STUDY_ID = document.getElementById("STUDY_ID").value;
        var SESSION_ID = document.getElementById("SESSION_ID").value;


        var sTestFlightParams = `PROLIFIC_PID=${create_UUID()}&STUDY_ID=${STUDY_ID || 'Classroom'}&SESSION_ID=${SESSION_ID || 'study'}`;
        // console.log(sTestFlightParams);
        try {
          var sURL = '/ostm/study?studyName=' + studyName + "&" + sTestFlightParams;
          console.log(sURL);
          window.location.href = sURL
        } catch (err) {
          consol.log("err" + err);
          return false;
        }
      };
    </script>
    <div id="footerContainer" class="row">
      <footer class="footer">
        <p class="text-muted">Solution by <a href="http://www.jeffreybarron.com">jeffreybarron.com</a> for
          <br />University of Wollongong. CRICOS Provider No: 00102E</p>
      </footer>
    </div>
    <!-- End of Main Body -->

    <!-- Bootstrap Footer, includes jQuery -->
    <!-- /.container -->
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <!--<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>-->
    <script src="https://code.jquery.com/jquery-3.3.1.js"
      integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
      integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
      crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
      integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
      crossorigin="anonymous"></script>


    <!-- Pages specific Scripts -->


    <!-- Close out HTML -->
</body>

</html>